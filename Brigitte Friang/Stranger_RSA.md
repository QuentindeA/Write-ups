# Stranger RSA

---

## Description

Un de nos agents est parvenu à dérober une clé privée et un fichier chiffré à Evil Gouv. Retrouvez l'information, avec un peu d'imagination

Le flag est juste une chaîne de caractères (sans le DGESIEE{})

## Resources

* [private.pem](Stranger_RSA/private.pem)
* [EVIL-FILE.txt.enc](Stranger_RSA/EVIL-FILE.txt.enc)

## Resolution

We have a private key and a encrypted file, so let's decrypt it.

```bash
openssl rsautl -decrypt -inkey private.pem -in EVIL-FILE.txt.enc -out EVIL-FILE.txt
```

And then, all we have inside is : `221 x 7`
So no more information there.

What about the private. We can dump the key with RsaCtfTools.

```bash
python RsaCtfTool.py --key private.pem --dumpkey
n: 803857121003958052057548999025727914644244855167224353653610582624284270852281769343834756552798777318177334025881626463982560613498507324011960845516395954830963002697541989489552205515849825433006261590219204851675793978102731544480597154074617679587300560106610843265282201124141677106743131008351636296867853811755729703846584586811896306037470591007050039713248197817633699325886404121414581938128224055180850726895346128328727206613279882561360530415813988080343274885394842977704274891899564259045724714688254544833025141709285938259130052212196269051476686369437239106076952050338005289120800431861185976871616130554067218043253317410750888208950644888598773942529059744136880913430525625902548117399206206783469474609862786775483914300821308073285902045042783350152154015100848707646535825731879576863756170317541805496668757800670502285626596491260736094077037938534212857633747017444675755418044159320253798988309385480432997014676810693140460728135781496331971868124809737017912712025139712696000812326538932672546976086279421859500666432936541084174783705287031026143212664598018907104402431539439479727045335384651307210481617401117670330341062265101511744062319958857149408432246050213206602258705253503041154650925231139661977091445330324091497765020009951678178379766897248854877519591395038524480642651128241858451194452261374997033325820619892057107017064574833671841712385525469833659108921368807484273084147762201192150140557582188414728869025651019985153175347688356933635821171381617670157694371323037016210269066456276695063995977812021514221288724318485224611330860746762230185406805007723318789780968987733199351211776265739213965685617302742602446391533636490014476984729975700670492300152267748297466891588415830665550830419983014435321914871467985714653603108568301186764092868143471381128147141085388948153957355575202274506687786557317715151381703993639729013188120121337588446441743446172029796134682860301704386713722974291027481874518594753886043416495269412383097993858010817957593502025796943870998245737432516708541503986123336119267113249523034126413220066788268166285036239235977472383693483120769452854533082566482756512659537523431923471939146151960892573465147847210646606656757519541447836777335851674282389702849125263918736666988163098344177568096354659882389534660141438347696976272577125699917428990371535840360514721516490249065671035950096352099737837791964122801152051038620167815643560582658762874179394515833266630550734931660020772346462643886933469400305168224063388864436162619793368060817320677954971988434611430817380106954088447084772443689554943902934587107400695447163101938005411343867323651821780249626927164154043328799444310847830480699660653269267300160955469472737109437656617835893502278116808486191519506107847281418296139341100292392602309757612781522390504743584737059575075112702802318926023858467601409951021114577892702987533898347832262641775873659917750733836306255055804426294667546652056627840127484876815075340829088146992973789969913713369674380717809903788571152189762401677074896013051142195644780525472099877717499589772964664501095257321077
e: 65537
d: 15945408811894738356574357976920614142202394246263815245581789789150701925751351147397427155936927392368136079369609753317627123572150991366946138809700089129503210453740705041982664253331778584050355372801394117936105286655378656450932699090544318224262488794705190903533375977865696938199277817276609048109132397810129371423784426550734168452152398924411630859319508936370657935573070561024138372515780265677939270106412407751763818432294182634691375704419765697307570644842047940415575283572171956860390956697662860800508608636679611818314373069805684571569032642328278847641790708537763505742665067998528186672156201378157184238769386951401134544938520810460936663644777418364861760340871314122912439577932588748623072722169486287259549393336095648187614212712751855519749152686743417000175421112523360085491905662645594811261873218805738025410296098976745302993731011796305548238763921489816111235538053421980407078212341137442404994416586873080589574539214732826213641585093194044940820080758680234139509834513337694345347954776130253404197115565520292497783218897312057829717204998358554392720496223526730299604176816150368484575523789942367997153415337055891561519157360674341123807344246231551163204545780697223759113877699627409868779756151935873154814753894943881801606629796396287766311785232976030056683025565203082472291267344245044725015236687762022586311887696221733881536019365901868925291691682247428621313294659365878050493350700472175094183892050999068933566198513738254935785396383662709175046198067045304500867445662651017037447468928324882728351963034778771731168517280867603241941099028793889013827789695288754881342006145707514075780902110913711199397345586885145715610473831673284660450012175478709799808866789241313090926870953204650332510421442429912048220602923446358215591297183346513445398588337691193362662916820672390479496645681565059238732584032919593004363714176620496702875819361939778100749160568328855026269040734764708915114030368049241197211610048066472510882595389342587019969050774405229466413281091238016820326828472507577116011282288119211934105197985895648627177442499214828375720688293417676874833614237462409319988942464032881307335543789897155337688505980667523507398577157939141761269053801081138488464934587821775979404034651235961866034576456163367901493337711122869759788828601919473229358511716289112770525167014768835846700049956021584682226186199108707761026890401749104002176175763478847685084492738756469594895768600130473019925211426395129467785815798025475642486994201074555744776594645771791325129435664164351447713588577861968446930518841451982186310192942337192716427158076861309372959861365762062250468098559385717766972267520429742490779878102713359019216896973484017062540713651208937471053124538924611188355015653520434967980844160960017896559749677739836831970299957303702790638143784492223800170108470733198748180901031483537704796515226835353377588885649489170034972827821917372668419250321076804583421054310360355279627234758164926288339215084823556189424531484201666075959991212603361326981888580340040410799920442434156472695469911231440688205407473
p: 8888887778888888877777777788888888777777888888888877777788887777777777887777777777888877777777888888888777778888888888877788888888877777788888887778888888887777778888888888777777888888887778888888888887777778888888877788888888888111988888881111111111138889111111111888887111111118883111111111188111111111188881111111111188889111111118888888811118888888111111119888888111988888891111111118888871111111111888888111188888888711111111888888811118888888888118111888888319888888871188888888881188881138888888888713888888888888888831188888118888888811888888888811988888311811888889118888888888888118111888888888888811888811188888888888888118311888888111888888888888111811888888888118883198888831188888888311888888891188888113111111188871111111118888888811388888811888888888118888811111888888118881188888113111111188888118883198888888888911888881188888888888888118889118888811311111118888118881188888887111111111188883138888888811888888111888888811888888311887118888888888888811388888881188888888113888888888811881117319119188811888888811887111111111188888881118888888118888888888888111111111188881188888891181117313117188883118888888111888111733311111788811117889188887111339111888311899999338888811388888888118333311113888119997311188999111311918888111939111183118888888111888111178891888881111333331187118888888111888811133911178399113111718888997888888889978879999999977888879999999998888887999997888879999999999888879788888888799999999778888879999997788888888889988888887999997788997888888889978799999999988888877799999778797888888889978888799999778888888889998611
q: 90433937405883214529183098366445396441894368833772641614616868688702155981836117800860528090045909819457847984422961231122015129615827241797294815950401688038164207693330620586892825861885455201684647325109792523305186169149870607955368355821877413144510184353503906371030728354252325624659661059930805645536017334162293642096265934896622312244699573952624716881146632927666360373385914817443670125470894777221378758430176024373583256558634543713202049838688844137704348616815161715577128618961802924655629436277124236861551023990901437346105104433466446363785603376479935177034468743750385615475697528093045910079092404462371925951096621246301400689945167445407839148479973848536587260390416715558432235723004861630330438593834581237719038762054407541888370079410107470547260319025654290778048670934017599989672573571549393679312942420060502315710424249073488400487473086271762914304964234812844196964872681861987578200955197127415338352403450639967724946667921594230867512290392179739523773333093526474673468654214338640142945109413952819033824396312823233382252076915619207100515544080590380623455592788485431883841608200425438708496952318102082359713008368292398919515835705678944800663435644363515379152770976527711598872260680001459830104284867490344529896649833582547563167963114645927243991834393888069181411918332852647177098461740720388674863868499199294256124508603011237685651702213959085586980160495807904782645032421331178985036744674325582879705940816983534464174754154762665247127752619191568898438317212531106521663866052502524597205757969022807
```

The first thing we can notify, is the strange aspect of p, using some stack of the same number, and a lot of 8. P is 1561 caraters long when 221x7=1547. Almost...
Trying to find some data in p, we finaly discover something interresting. Displaying p in line of 221 caraters long, some kind of letters appear. Cleaning it up by replacing 8 by void, and straithening out by displaying in line of 223 caraters long, we get:

```txt
      777        777777777        777777          777777    7777777777  7777777777    77777777         77777           777         777777       777         777777          777777        777            777777        777
      1119       111111111113   9111111111     711111111   31111111111  1111111111    11111111111    911111111        1111       111111119      1119      9111111111     71111111111      1111        711111111       1111
     11 111      319       711          11    113          713                311     11        11          119     311 11     911             11 111             11    111              11 311      111            111 11
    11   319     311        311       911     1131111111   7111111111        113      11         11     11111      11   11     1131111111     11   319          911     11              11   911     1131111111    11   11
  71111111111    313        11      111       11      311  711              113       11        113          11  11173191191   11       11  71111111111       111       11             1111111111    11      911 11173131171
 311       111   1117333111117   11117  91    7111339111   311 9999933     113        11 333311113   1199973111  99911131191    1119391111 311       111   11117  91     11113333311 711       111    1113391117 39911311171
 997        997  79999999977    7999999999      7999997    79999999999    797        79999999977     799999977          99       79999977  997        997 7999999999      7779999977 797        997    79999977         999 611
```

## Opinion

The challenge wasn't to hard. The only problem we had was the hint 221 x 7 instead of 223 x 7. So we wasn't sure where to search.
